{"version":3,"sources":["webpack:///static/js/worker.bundle.js","webpack:///webpack/bootstrap 6678163c3d7526f29711?67b1","webpack:///./src/worker/index.js","webpack:///./~/aggregate-array-extensions/aggregate.js?a662","webpack:///./~/aggregate-array-extensions/groupBy.js?c451","webpack:///./~/aggregate-array-extensions/index.js?9e38","webpack:///./~/aggregate-array-extensions/map.js?fb23","webpack:///./~/aggregate-array-extensions/nearestBound.js?58a8","webpack:///./src/worker/parseFile.js?689e","webpack:///./src/worker/topTenMovers.js?1ea3","webpack:///(webpack)-worker/api.js","webpack:///(webpack)-worker/worker.common.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","0","_interopRequireDefault","obj","__esModule","default","_api","_api2","_parseFile","_parseFile2","_topTenMovers2","_topTenMovers3","filename","fetch","then","response","text","data","topTenMovers","filter","32","Array","prototype","sum","selector","this","reduce","item","33","groupBy","keySelector","elementSelector","aggregateTransform","result","hash","group","entry","key","value","push","Object","keys","map","x","groupIntoObject","forEach","34","35","mapIntoObject","valueSelector","target","36","nearestBound","source","upper","valueAt","index","currentIndex","currentValue","minIndex","maxIndex","length","undefined","Math","min","max","nearestUpperBound","nearestLowerBound","findRange","lower","lowerBound","upperBound","slice","38","parse","yearsToAdd","trim","split","line","parseDate","values","stock","start","low","high","end","sort","sortGroups","defineProperty","concat","Date","substr","a","b","39","filtered","stocks","aggregate","day","existing","today","topMovers","gain","y","type","209","common","worker","operations","onmessage","e","emit","emitError","userEmit","Promise","resolve","param","catch","error","close","operation","Error","212","isError","constructor","some","word","name","toLowerCase","includes","self","postMessage","assign","wrapError","message","stack","userData","user","delayed","valueToChain"],"mappings":"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","file":"static/js/worker.bundle.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/webpack-worker/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ 0:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _api = __webpack_require__(209);\n\t\n\tvar _api2 = _interopRequireDefault(_api);\n\t\n\tvar _parseFile = __webpack_require__(38);\n\t\n\tvar _parseFile2 = _interopRequireDefault(_parseFile);\n\t\n\tvar _topTenMovers2 = __webpack_require__(39);\n\t\n\tvar _topTenMovers3 = _interopRequireDefault(_topTenMovers2);\n\t\n\t__webpack_require__(34);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t// we can perform initialization by returning a promise here\n\t// arguments are passed from the client\n\t(0, _api2.default)(function (filename) {\n\t  return fetch(filename).then(function (response) {\n\t    return response.text();\n\t  }).then(function (text) {\n\t    var data = (0, _parseFile2.default)(text\n\t    // then return the api we want to expose at the end of the promise chain\n\t    );return {\n\t      topTenMovers: function topTenMovers(filter) {\n\t        return (0, _topTenMovers3.default)(data, filter);\n\t      }\n\t    };\n\t  });\n\t});\n\n/***/ },\n\n/***/ 32:\n/***/ function(module, exports) {\n\n\t/* eslint-disable no-extend-native */\r\n\tArray.prototype.sum = function(selector) {\r\n\t  return this.reduce(function (sum, item) {\r\n\t    return sum + (selector ? selector(item) : item)\r\n\t  }, 0)\r\n\t}\n\n/***/ },\n\n/***/ 33:\n/***/ function(module, exports) {\n\n\t/* eslint-disable no-extend-native */\r\n\tArray.prototype.groupBy = function(keySelector, elementSelector, aggregateTransform) {\r\n\t  var result = this.reduce(function(hash, item) {\r\n\t    var group = keySelector(item)\r\n\t    var entry = (hash[group] = hash[group] || { key: group, value: [] })\r\n\t    entry.value.push(elementSelector ? elementSelector(item) : item)\r\n\t    return hash\r\n\t  }, {})\r\n\t\r\n\t  return Object.keys(result)\r\n\t    .map(function(x) {\r\n\t      return {\r\n\t        key: result[x].key,\r\n\t        value: aggregateTransform ? aggregateTransform(result[x].value) : result[x].value\r\n\t      }\r\n\t    })\r\n\t}\r\n\t\r\n\tArray.prototype.groupIntoObject = function(keySelector, elementSelector, aggregateTransform) {\r\n\t  var result = this.reduce(function(hash, item) {\r\n\t    var group = keySelector(item)\r\n\t    var entry = (hash[group] = hash[group] || [])\r\n\t    entry.push(elementSelector ? elementSelector(item) : item)\r\n\t    return hash\r\n\t  }, {})\r\n\t\r\n\t  if(aggregateTransform)\r\n\t    Object.keys(result).forEach(function(key) {\r\n\t      return result[key] = aggregateTransform(result[key])\r\n\t    })\r\n\t\r\n\t  return result\r\n\t}\r\n\t\r\n\t// Array.prototype.aggregateGroups = function(aggregateTransform) {\r\n\t//   var result = this.reduce((hash, firstGroup) => {\r\n\t//     firstGroup.value.forEach(secondGroup => {\r\n\t//       hash[secondGroup.key] = hash[secondGroup.key] || { key: secondGroup.key, value: [] }\r\n\t//       hash[secondGroup.key].value.push(secondGroup)\r\n\t//     })\r\n\t//     return hash\r\n\t//   }, {})\r\n\t\r\n\t//   return Object.keys(result)\r\n\t//     .map(x => ({\r\n\t//       key: result[x].key,\r\n\t//       value: aggregateTransform ? aggregateTransform(result[x].value) : result[x].value\r\n\t//     }))\r\n\t// }\r\n\n\n/***/ },\n\n/***/ 34:\n/***/ function(module, exports, __webpack_require__) {\n\n\t__webpack_require__(33)\r\n\t__webpack_require__(36)\r\n\t__webpack_require__(32)\r\n\t__webpack_require__(35)\n\n/***/ },\n\n/***/ 35:\n/***/ function(module, exports) {\n\n\tArray.prototype.mapIntoObject = function(keySelector, valueSelector) {\r\n\t  return this.reduce(function(target, item) {\r\n\t    target[keySelector(item)] = valueSelector ? valueSelector(item) : item\r\n\t    return target\r\n\t  }, {})\r\n\t}\n\n/***/ },\n\n/***/ 36:\n/***/ function(module, exports) {\n\n\t/* eslint-disable no-extend-native */\r\n\t// these extensions require the array to be sorted by the selector\r\n\tArray.prototype.nearestUpperBound = function(value, selector) {\r\n\t  return nearestBound(this, value, true, selector)\r\n\t}\r\n\t\r\n\tArray.prototype.nearestLowerBound = function(value, selector) {\r\n\t  return nearestBound(this, value, false, selector)\r\n\t}\r\n\t\r\n\tArray.prototype.findRange = function(lower, upper, selector) {\r\n\t  var lowerBound = this.nearestLowerBound(lower, selector)\r\n\t  if(lowerBound === -1) return [];\r\n\t  var upperBound = this.nearestUpperBound(upper, selector)\r\n\t  if(upperBound === -1) return [];\r\n\t\r\n\t  return this.slice(lowerBound, upperBound + 1)\r\n\t}\r\n\t\r\n\tfunction nearestBound(source, value, upper, selector) {\r\n\t  var minIndex = 0, maxIndex = source.length - 1, currentIndex, currentValue\r\n\t\r\n\t  if(source.length === 0)\r\n\t    return -1\r\n\t\r\n\t  if(value === undefined || value === null)\r\n\t    return upper ? source.length - 1 : 0\r\n\t\r\n\t  if((upper && value < valueAt(0)) || (!upper && value > valueAt(source.length - 1)))\r\n\t    return -1\r\n\t\r\n\t  while (minIndex <= maxIndex) {\r\n\t    currentIndex = (minIndex + maxIndex) / 2 | 0\r\n\t    currentValue = valueAt(currentIndex)\r\n\t\r\n\t    if (currentValue < value)\r\n\t      minIndex = currentIndex + 1\r\n\t    else if (currentValue > value)\r\n\t      maxIndex = currentIndex - 1\r\n\t    else\r\n\t      return currentIndex\r\n\t  }\r\n\t\r\n\t  return upper\r\n\t    ? Math.min(currentIndex, maxIndex)\r\n\t    : Math.max(currentIndex, minIndex)\r\n\t\r\n\t  function valueAt(index) {\r\n\t    return selector ? selector(source[index]) : source[index]\r\n\t  }\r\n\t}\n\n/***/ },\n\n/***/ 38:\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\texports.default = function (text) {\n\t  // duplicate the same year's worth of data over five years to better demonstrate the lag without workers\n\t  return parse(text, 0).concat(parse(text, 1)).concat(parse(text, 2)).concat(parse(text, 3)).concat(parse(text, 4));\n\t};\n\t\n\t// data provided by http://pages.swcp.com/stocks/\n\t// format is CSV (date, stock, start, low, high, end, ?)\n\t\n\tvar parseDate = function parseDate(value, yearsToAdd) {\n\t  return new Date(+value.substr(0, 4) + yearsToAdd, +value.substr(4, 2), +value.substr(6, 2));\n\t};\n\tvar sortGroups = function sortGroups(a, b) {\n\t  return a.key - b.key;\n\t};\n\t\n\tfunction parse(text, yearsToAdd) {\n\t  return text.trim().split('\\n').groupBy(function (line) {\n\t    return parseDate(line, yearsToAdd);\n\t  }, function (line) {\n\t    var values = line.split(',');\n\t    return {\n\t      stock: values[1],\n\t      start: +values[2],\n\t      low: +values[3],\n\t      high: +values[4],\n\t      end: +values[5]\n\t    };\n\t  }, function (group) {\n\t    return group.mapIntoObject(function (x) {\n\t      return x.stock;\n\t    });\n\t  }).sort(sortGroups);\n\t}\n\n/***/ },\n\n/***/ 39:\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\texports.default = function (data, filter) {\n\t  // filter our data the the selected date range\n\t  var filtered = data.findRange(filter.min, filter.max, function (x) {\n\t    return x.key;\n\t  }\n\t\n\t  // aggregate the data for each stock\n\t  );var stocks = filtered.reduce(function (aggregate, day) {\n\t    Object.keys(day.value).forEach(function (stock) {\n\t      var existing = aggregate[stock] || {};\n\t      var today = day.value[stock];\n\t\n\t      aggregate[stock] = {\n\t        stock: stock,\n\t        start: existing.start || today.start,\n\t        end: today.end,\n\t        high: existing.high > today.high ? existing.high : today.high,\n\t        low: existing.low < today.low ? existing.low : today.low\n\t      };\n\t    });\n\t    return aggregate;\n\t  }, {}\n\t\n\t  // find our top ten movers\n\t  );var topMovers = Object.keys(stocks).map(function (stock) {\n\t    return {\n\t      stock: stock,\n\t      gain: (stocks[stock].end - stocks[stock].start) / stocks[stock].start\n\t    };\n\t  }).sort(function (a, b) {\n\t    return b.gain - a.gain;\n\t  }).slice(0, 10\n\t\n\t  // map into vectors that Plotly understands\n\t  );return {\n\t    x: topMovers.map(function (x) {\n\t      return x.stock;\n\t    }),\n\t    y: topMovers.map(function (x) {\n\t      return x.gain;\n\t    }),\n\t    type: 'bar'\n\t  };\n\t};\n\n/***/ },\n\n/***/ 209:\n/***/ function(module, exports, __webpack_require__) {\n\n\t/* eslint-disable no-restricted-globals */\r\n\t/* eslint-disable no-undef */\r\n\tvar common = __webpack_require__(212)\r\n\t\r\n\tmodule.exports = function(worker) {\r\n\t  var operations\r\n\t\r\n\t  onmessage = function(e) {\r\n\t    var emit = common.emit(e.data.id)\r\n\t    var emitError = common.emitError(emit)\r\n\t    var userEmit = common.userEmit(emit)\r\n\t\r\n\t    try {\r\n\t      switch(e.data.type) {\r\n\t        case 'init':\r\n\t          Promise.resolve(worker(e.data.param, userEmit))\r\n\t            .then(function(result) {\r\n\t              operations = result\r\n\t              emit({ result: { type: 'api', operations: Object.keys(result) } })\r\n\t            })\r\n\t            .catch(function(error) {\r\n\t              emitError(error)\r\n\t              close()\r\n\t            })\r\n\t          break;\r\n\t\r\n\t        case 'invoke':\r\n\t          if(!operations[e.data.operation])\r\n\t            emitError(new Error('Unknown operation: ' + e.data.operation))\r\n\t          \r\n\t            Promise.resolve(operations[e.data.operation](e.data.param, userEmit))\r\n\t              .then(function(result) { emit({ result: result }) })\r\n\t              .catch(emitError)\r\n\t          break;\r\n\t\r\n\t        default:\r\n\t          emitError(new Error('Unknown internal operation: ' + e.data.type))\r\n\t      }\r\n\t    } catch(error) {\r\n\t      emitError(error)\r\n\t      close()\r\n\t    }\r\n\t  }\r\n\t}\r\n\n\n/***/ },\n\n/***/ 212:\n/***/ function(module, exports) {\n\n\tvar common = module.exports = { \r\n\t  emit: function(id) {\r\n\t    return function(data) {\r\n\t      self.postMessage(Object.assign({ id: id }, data))\r\n\t    }\r\n\t  },\r\n\t  wrapError: function(error) {\r\n\t    return isError(error) ? { message: error.message, stack: error.stack } : error\r\n\t  },\r\n\t  emitError: function(emit) {\r\n\t    return function(error) {\r\n\t      emit({ error: common.wrapError(error) })\r\n\t    }\r\n\t  },\r\n\t  userEmit: function(emit) {\r\n\t    userEmit = function(userData) { \r\n\t      emit({ user: userData })\r\n\t    }\r\n\t    userEmit.delayed = function(userData) { \r\n\t      return function(valueToChain) { \r\n\t        emit({ user: userData }) \r\n\t        return valueToChain\r\n\t      }\r\n\t    }\r\n\t    return userEmit\r\n\t  }\r\n\t}\r\n\t\r\n\tfunction isError(target) {\r\n\t  return !!(target && (target.constructor === Error || ['error', 'exception'].some(function(word) { \r\n\t    return target.constructor.prototype.constructor.name.toLowerCase().includes(word) \r\n\t  })))\r\n\t}\n\n/***/ }\n\n/******/ });\n\n\n// WEBPACK FOOTER //\n// static/js/worker.bundle.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/webpack-worker/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 6678163c3d7526f29711","import api from 'webpack-worker/api'\r\nimport parseFile from './parseFile'\r\nimport topTenMovers from './topTenMovers'\r\nimport 'aggregate-array-extensions'\r\n\r\n// we can perform initialization by returning a promise here\r\n// arguments are passed from the client\r\napi(filename =>\r\n  fetch(filename)\r\n    .then(response => response.text())\r\n    .then(text => {\r\n      var data = parseFile(text)\r\n      // then return the api we want to expose at the end of the promise chain\r\n      return {\r\n        topTenMovers: filter => topTenMovers(data, filter)\r\n      }\r\n    })\r\n)\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/worker/index.js","/* eslint-disable no-extend-native */\r\nArray.prototype.sum = function(selector) {\r\n  return this.reduce(function (sum, item) {\r\n    return sum + (selector ? selector(item) : item)\r\n  }, 0)\r\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/aggregate-array-extensions/aggregate.js\n// module id = 32\n// module chunks = 0 1","/* eslint-disable no-extend-native */\r\nArray.prototype.groupBy = function(keySelector, elementSelector, aggregateTransform) {\r\n  var result = this.reduce(function(hash, item) {\r\n    var group = keySelector(item)\r\n    var entry = (hash[group] = hash[group] || { key: group, value: [] })\r\n    entry.value.push(elementSelector ? elementSelector(item) : item)\r\n    return hash\r\n  }, {})\r\n\r\n  return Object.keys(result)\r\n    .map(function(x) {\r\n      return {\r\n        key: result[x].key,\r\n        value: aggregateTransform ? aggregateTransform(result[x].value) : result[x].value\r\n      }\r\n    })\r\n}\r\n\r\nArray.prototype.groupIntoObject = function(keySelector, elementSelector, aggregateTransform) {\r\n  var result = this.reduce(function(hash, item) {\r\n    var group = keySelector(item)\r\n    var entry = (hash[group] = hash[group] || [])\r\n    entry.push(elementSelector ? elementSelector(item) : item)\r\n    return hash\r\n  }, {})\r\n\r\n  if(aggregateTransform)\r\n    Object.keys(result).forEach(function(key) {\r\n      return result[key] = aggregateTransform(result[key])\r\n    })\r\n\r\n  return result\r\n}\r\n\r\n// Array.prototype.aggregateGroups = function(aggregateTransform) {\r\n//   var result = this.reduce((hash, firstGroup) => {\r\n//     firstGroup.value.forEach(secondGroup => {\r\n//       hash[secondGroup.key] = hash[secondGroup.key] || { key: secondGroup.key, value: [] }\r\n//       hash[secondGroup.key].value.push(secondGroup)\r\n//     })\r\n//     return hash\r\n//   }, {})\r\n\r\n//   return Object.keys(result)\r\n//     .map(x => ({\r\n//       key: result[x].key,\r\n//       value: aggregateTransform ? aggregateTransform(result[x].value) : result[x].value\r\n//     }))\r\n// }\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/aggregate-array-extensions/groupBy.js\n// module id = 33\n// module chunks = 0 1","require('./groupBy')\r\nrequire('./nearestBound')\r\nrequire('./aggregate')\r\nrequire('./map')\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/aggregate-array-extensions/index.js\n// module id = 34\n// module chunks = 0 1","Array.prototype.mapIntoObject = function(keySelector, valueSelector) {\r\n  return this.reduce(function(target, item) {\r\n    target[keySelector(item)] = valueSelector ? valueSelector(item) : item\r\n    return target\r\n  }, {})\r\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/aggregate-array-extensions/map.js\n// module id = 35\n// module chunks = 0 1","/* eslint-disable no-extend-native */\r\n// these extensions require the array to be sorted by the selector\r\nArray.prototype.nearestUpperBound = function(value, selector) {\r\n  return nearestBound(this, value, true, selector)\r\n}\r\n\r\nArray.prototype.nearestLowerBound = function(value, selector) {\r\n  return nearestBound(this, value, false, selector)\r\n}\r\n\r\nArray.prototype.findRange = function(lower, upper, selector) {\r\n  var lowerBound = this.nearestLowerBound(lower, selector)\r\n  if(lowerBound === -1) return [];\r\n  var upperBound = this.nearestUpperBound(upper, selector)\r\n  if(upperBound === -1) return [];\r\n\r\n  return this.slice(lowerBound, upperBound + 1)\r\n}\r\n\r\nfunction nearestBound(source, value, upper, selector) {\r\n  var minIndex = 0, maxIndex = source.length - 1, currentIndex, currentValue\r\n\r\n  if(source.length === 0)\r\n    return -1\r\n\r\n  if(value === undefined || value === null)\r\n    return upper ? source.length - 1 : 0\r\n\r\n  if((upper && value < valueAt(0)) || (!upper && value > valueAt(source.length - 1)))\r\n    return -1\r\n\r\n  while (minIndex <= maxIndex) {\r\n    currentIndex = (minIndex + maxIndex) / 2 | 0\r\n    currentValue = valueAt(currentIndex)\r\n\r\n    if (currentValue < value)\r\n      minIndex = currentIndex + 1\r\n    else if (currentValue > value)\r\n      maxIndex = currentIndex - 1\r\n    else\r\n      return currentIndex\r\n  }\r\n\r\n  return upper\r\n    ? Math.min(currentIndex, maxIndex)\r\n    : Math.max(currentIndex, minIndex)\r\n\r\n  function valueAt(index) {\r\n    return selector ? selector(source[index]) : source[index]\r\n  }\r\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/aggregate-array-extensions/nearestBound.js\n// module id = 36\n// module chunks = 0 1","// data provided by http://pages.swcp.com/stocks/\r\n// format is CSV (date, stock, start, low, high, end, ?)\r\n\r\nconst parseDate = (value, yearsToAdd) => new Date(+value.substr(0, 4) + yearsToAdd, +value.substr(4, 2), +value.substr(6, 2))\r\nconst sortGroups = (a, b) => a.key - b.key\r\n\r\nexport default function(text) {\r\n  // duplicate the same year's worth of data over five years to better demonstrate the lag without workers\r\n  return parse(text, 0)\r\n    .concat(parse(text, 1))\r\n    .concat(parse(text, 2))\r\n    .concat(parse(text, 3))\r\n    .concat(parse(text, 4))\r\n}\r\n\r\nfunction parse(text, yearsToAdd) {\r\n  return text.trim().split('\\n').groupBy(line => parseDate(line, yearsToAdd),\r\n    line => {\r\n      var values = line.split(',')\r\n      return {\r\n        stock: values[1],\r\n        start: +values[2],\r\n        low: +values[3],\r\n        high: +values[4],\r\n        end: +values[5]\r\n      }\r\n    },\r\n    group => group.mapIntoObject(x => x.stock)\r\n  ).sort(sortGroups)\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/worker/parseFile.js","export default function (data, filter) {\r\n  // filter our data the the selected date range\r\n  var filtered = data.findRange(filter.min, filter.max, x => x.key)\r\n\r\n  // aggregate the data for each stock\r\n  var stocks = filtered.reduce((aggregate, day) => {\r\n    Object.keys(day.value).forEach(stock => {\r\n      var existing = aggregate[stock] || {}\r\n      var today = day.value[stock]\r\n\r\n      aggregate[stock] = {\r\n        stock: stock,\r\n        start: existing.start || today.start,\r\n        end: today.end,\r\n        high: existing.high > today.high ? existing.high : today.high,\r\n        low: existing.low < today.low ? existing.low : today.low\r\n      }\r\n    })\r\n    return aggregate\r\n  }, {})\r\n\r\n  // find our top ten movers\r\n  var topMovers = Object.keys(stocks)\r\n    .map(stock => ({\r\n      stock: stock,\r\n      gain: (stocks[stock].end - stocks[stock].start) / stocks[stock].start\r\n    }))\r\n    .sort((a, b) => b.gain - a.gain)\r\n    .slice(0, 10)\r\n  \r\n  // map into vectors that Plotly understands\r\n  return {\r\n    x: topMovers.map(x => x.stock),\r\n    y: topMovers.map(x => x.gain),\r\n    type: 'bar'\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/worker/topTenMovers.js","/* eslint-disable no-restricted-globals */\r\n/* eslint-disable no-undef */\r\nvar common = require('./worker.common')\r\n\r\nmodule.exports = function(worker) {\r\n  var operations\r\n\r\n  onmessage = function(e) {\r\n    var emit = common.emit(e.data.id)\r\n    var emitError = common.emitError(emit)\r\n    var userEmit = common.userEmit(emit)\r\n\r\n    try {\r\n      switch(e.data.type) {\r\n        case 'init':\r\n          Promise.resolve(worker(e.data.param, userEmit))\r\n            .then(function(result) {\r\n              operations = result\r\n              emit({ result: { type: 'api', operations: Object.keys(result) } })\r\n            })\r\n            .catch(function(error) {\r\n              emitError(error)\r\n              close()\r\n            })\r\n          break;\r\n\r\n        case 'invoke':\r\n          if(!operations[e.data.operation])\r\n            emitError(new Error('Unknown operation: ' + e.data.operation))\r\n          \r\n            Promise.resolve(operations[e.data.operation](e.data.param, userEmit))\r\n              .then(function(result) { emit({ result: result }) })\r\n              .catch(emitError)\r\n          break;\r\n\r\n        default:\r\n          emitError(new Error('Unknown internal operation: ' + e.data.type))\r\n      }\r\n    } catch(error) {\r\n      emitError(error)\r\n      close()\r\n    }\r\n  }\r\n}\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)-worker/api.js\n// module id = 209\n// module chunks = 1","var common = module.exports = { \r\n  emit: function(id) {\r\n    return function(data) {\r\n      self.postMessage(Object.assign({ id: id }, data))\r\n    }\r\n  },\r\n  wrapError: function(error) {\r\n    return isError(error) ? { message: error.message, stack: error.stack } : error\r\n  },\r\n  emitError: function(emit) {\r\n    return function(error) {\r\n      emit({ error: common.wrapError(error) })\r\n    }\r\n  },\r\n  userEmit: function(emit) {\r\n    userEmit = function(userData) { \r\n      emit({ user: userData })\r\n    }\r\n    userEmit.delayed = function(userData) { \r\n      return function(valueToChain) { \r\n        emit({ user: userData }) \r\n        return valueToChain\r\n      }\r\n    }\r\n    return userEmit\r\n  }\r\n}\r\n\r\nfunction isError(target) {\r\n  return !!(target && (target.constructor === Error || ['error', 'exception'].some(function(word) { \r\n    return target.constructor.prototype.constructor.name.toLowerCase().includes(word) \r\n  })))\r\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)-worker/worker.common.js\n// module id = 212\n// module chunks = 1"],"sourceRoot":""}